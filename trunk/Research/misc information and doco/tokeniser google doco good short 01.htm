<html><head><meta HTTP-EQUIV="content-type" CONTENT="text/html; charset=ISO-8859-1"><title>Google Search:  </title><style><!--
body,td,div,.p,a{font-family:arial,sans-serif }
div,td{color:#000}
.f,.fl:link{color:#6f6f6f}
a:link,.w,a.w:link,.w a:link{color:#00c}
a:visited,.fl:visited{color:#551a8b}
a:active,.fl:active{color:#f00}
.t a:link,.t a:active,.t a:visited,.t{color:#000000}
.t{background-color:#ffcc33}
.h{color:#ddaa11;font-size:14px}
.i,.i:link{color:#a90a08}
.a,.a:link{color:#008000}
.z{display:none}
div.n {margin-top: 1ex}
.n a{font-size:10pt; color:#000}
.n .i{font-size:10pt; font-weight:bold}
.q a:visited,.q a:link,.q a:active,.q {text-decoration: none; color: #00c;}
.b{font-size: 12pt; color:#00c; font-weight:bold}
.ch{cursor:pointer;cursor:hand}
//-->
</style>
<script>
<!--
function ss(w){window.status=w;return true;}
function cs(){window.status='';}
//-->
</script>
<script>
<!--
function ga(o,e){if (document.getElementById){a=o.id.substring(1); p = "";r = "";g = e.target;if (g) { t = g.id;f = g.parentNode;if (f) {p = f.id;h = f.parentNode;if (h) r = h.id;}} else{h = e.srcElement;f = h.parentNode;if (f) p = f.id;t = h.id;}if (t==a || p==a || r==a) return true;location.href=document.getElementById(a).href}}
//-->
</script>
</head><body bgcolor=#ffffff onLoad="document.gs.reset()"><table border=0 cellpadding=0 cellspacing=0><tr><td rowspan=3 valign=top><table cellpadding=0 cellspacing=0 border=0><tr><td align=right valign=bottom><a href=http://groups.google.com/grphp?hl=en><img src=/images/res0.gif alt="Go to Google Groups Home" border=0 width=110 height=58></a></td><td valign=bottom><a href=http://groups.google.com/grphp?hl=en><img src=/images/res1.gif border=0 width=38 height=58 alt=""></a></td><td valign=bottom><a href=http://groups.google.com/grphp?hl=en><img src=/images/res2.gif border=0 width=52 height=58 alt=""></a></td></tr><tr><td align=right valign=top class=h><b>Groups</b></td><td valign=top><a href=http://groups.google.com/grphp?hl=en><img src=/images/res3.gif border=0 width=38 height=20 alt=""></a></td><td valign=top><font color=#6f6f6f style=font-size:14px>&nbsp;</font></td></tr></table></td><td nowrap><font size=-1><a href=/advanced_group_search?hl=en&lr=&ie=UTF-8>Advanced&nbsp;Groups&nbsp;Search</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=/preferences?hl=en&lr=&ie=UTF-8>Preferences</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=/googlegroups/help.html>Groups Help</a>&nbsp;</font></td></tr><tr><td valign=middle><form name=gs method=GET action=/groups><input type=hidden name=hl value="en"><input type=hidden name=lr value=""><input type=hidden name=ie value="ISO-8859-1"><input type=text name=q size=31 maxlength=2048 value=""><font size=-1> <input type=submit name="btnG" value="Google Search"><span id=hf></span></font></td></tr><tr><td><font size=-1>&nbsp;</font></td></tr></form></table><table width=100% border=0 cellpadding=1 cellspacing=0 bgcolor=#ffcc33><tr><td bgcolor=#ffcc33 nowrap><table width=100% border=0 cellpadding=1 cellspacing=0 bgcolor=#ffcc33><tr><td bgcolor=#ffcc33 nowrap><font size=-1 color=#000000><b>Groups search result 2</b> for <b></b>&nbsp; </font></td></tr></table></td></tr></table><table cellSpacing=0 cellPadding=0 width="100%" border=0><tr><td height=5><img alt="" width=1 height=1></td></tr></table><table cellSpacing=0 cellPadding=2 width="100%" border=0 bgcolor=#EBFFED><tr><td class=ch id=taw0 onmouseover="ss('go to www.xmlspy.com')" onclick=ga(this,event) onmouseout=cs()><font size=-1>&nbsp;<a id=aw0 href=/url?q=http://www.xmlspy.com/ref/%3Fs%3Dgoogleaw%26q%3Dregularexpression&sa=l&ai=AgOZF7h0u-8o-PIpggcukBIM9pGAmcbeAA34tBIQAg7k-TAY8EEwABQ_D&num=1&client=ca-groups-message><b>XML Regular Expressions</b></a>&nbsp;&#149;&nbsp;<font class=f size=-2>Edit Regular Exp&#39;s for XML Schema&nbsp;XML Editor, Download a Free Trial.</font>&nbsp;&#149;&nbsp;<font color=green size=-1>www.xmlspy.com</font></td><td rowspan=3 valign=top align=right><font size=-2 color=6f6f6f>Sponsored Links</font>&nbsp;<br></td></tr><tr><td class=ch id=taw1 onmouseover="ss('go to www.abacre.com/afr/')" onclick=ga(this,event) onmouseout=cs()><font size=-1>&nbsp;<a id=aw1 href=/url?q=http://www.abacre.com/info.asp%3Fp%3Dafr%26c%3Dgglcpc&sa=l&ai=ATSgu7h0u-8o-PIpggcukBEe1MNp47PAwNebACIA4Op_EAGPBBMgA0_A&num=2&client=ca-groups-message><b>Advanced Find and Replace</b></a>&nbsp;&#149;&nbsp;<font class=f size=-2>Leading search and replace utility.&nbsp;Download here this useful program.</font>&nbsp;&#149;&nbsp;<font color=green size=-1>www.abacre.com/afr/</font></td></tr><tr><td class=ch id=taw2 onmouseover="ss('go to www.easysoft.com')" onclick=ga(this,event) onmouseout=cs()><font size=-1>&nbsp;<a id=aw2 href=/url?q=http://www.easysoft.com/products/google_redirect.phtml%3Fid%3D21&sa=l&ai=AQ1M47h0u-8o-PIpggcukBc63-Hw4RbrBA34tBIwAg7k-TAMuCEwADQ_D&num=3&client=ca-groups-message><b>ODBC Drivers for Python</b></a>&nbsp;&#149;&nbsp;<font class=f size=-2>Access any remote ODBC database&nbsp;from Python apps on Linux and unix</font>&nbsp;&#149;&nbsp;<font color=green size=-1>www.easysoft.com</font></td></tr></table><table cellSpacing=0 cellPadding=0 width="100%" border=0><tr><td height=5><img alt="" width=1 height=1></td></tr></table>
<table width=100% bgcolor=#e0e0e0 cellpadding=2 cellspacing=0 border=0><tr><td><font face=arial,sans-serif>

<table cellpadding=0 cellspacing=0 border=0 align=right><tr><td><font face=arial,sans-serif></font></td></tr></table>
From: <a href=/groups?hl=en&lr=&ie=UTF-8&q=author:aleax%40aleax.it+ >Alex Martelli</a> (<a href=mailto:aleax%40aleax.it>aleax@aleax.it</a>)<br>Subject: Re: pattern match <br><font face=arial,sans-serif><table cellpadding=0 cellspacing=0 border=0 align=right><tr><td>View: <a href=/groups?hl=en&lr=&ie=UTF-8&threadm=eOena.23056%24LB6.547891%40news1.tin.it&rnum=2&prev=/groups%3Fhl%3Den%26lr%3D%26ie%3DUTF-8%26selm%3DeOena.23056%2524LB6.547891%2540news1.tin.it%26rnum%3D2 >Complete Thread (7 articles)</a> </td></tr><tr><td align=right> <a href=/groups?selm=eOena.23056%24LB6.547891%40news1.tin.it&output=gplain >Original Format</a></td></tr></table></font>
Newsgroups: <a href=/groups?hl=en&lr=&ie=UTF-8&group=comp.lang.python >comp.lang.python</a><br>Date: 2003-04-16 08:38:50 PST <br></font></td></tr></table><pre>Gabor Nagy wrote:

<font color="#660066">&gt; I have a string, like '(FOO(1) BAR(&quot;2&quot;))'
&gt; 
&gt; I'd like to have a { 'FOO':1, 'BAR':'2' }
&gt; 
&gt; Is there an easy way to do this, or do I have to write parsing, maybe use
&gt; regexps, or something like that?</font>

Some parsing is obviously needed -- turning a string that respects
some syntax into &quot;more meaningful objects&quot; (in some appropriate
context for &quot;meaningful&quot;;-) is the DEFINITION of parsing.

You may or may not have to &quot;write parsing&quot;, depending on what syntax
you need to deal with in your input strings -- and regular expressions
may or may not be the best tools for the conceptually lower parts of
the parsing job (&quot;tokenizing&quot;).  If the tokens in your strings happen
to respect exactly the same rules as Python's tokens, in particular,
you can use the excellent tokenize module in the standard library...:

<font color="#990000">&gt;&gt;&gt; st = 'FOO(1) BAR(&quot;2&quot;)'
&gt;&gt;&gt; import tokenize
&gt;&gt;&gt; import cStringIO
&gt;&gt;&gt; for x in tokenize.generate_tokens(cStringIO.StringIO(st).readline):</font>
...   print x
...
(1, 'FOO', (1, 0), (1, 3), 'FOO(1) BAR(&quot;2&quot;)')
(50, '(', (1, 3), (1, 4), 'FOO(1) BAR(&quot;2&quot;)')
(2, '1', (1, 4), (1, 5), 'FOO(1) BAR(&quot;2&quot;)')
(50, ')', (1, 5), (1, 6), 'FOO(1) BAR(&quot;2&quot;)')
(1, 'BAR', (1, 7), (1, 10), 'FOO(1) BAR(&quot;2&quot;)')
(50, '(', (1, 10), (1, 11), 'FOO(1) BAR(&quot;2&quot;)')
(3, '&quot;2&quot;', (1, 11), (1, 14), 'FOO(1) BAR(&quot;2&quot;)')
(50, ')', (1, 14), (1, 15), 'FOO(1) BAR(&quot;2&quot;)')
(0, '', (2, 0), (2, 0), '')
<font color="#990000">&gt;&gt;&gt;</font>

as you see, you need to provide generate_tokens a &quot;readline-like&quot;
function -- when what you have to start with is a string, wrapping
a cStringIO.StringIO around the string and passing its bound
method .readline is generally simplest.

Each item x returned by looping on generate_tokens is a 5-items
tuple.  x[0] is an arbitrary code -- 1 means an identifier, 50
means punctuation, 2 a number, etc -- you can learn a little bit
more by checking the dictionary tokenize.tok_name.  x[1] is the
substring of the input string that corresponds to the token.
Then, you get indications of WHERE the token is in the input
string (where it starts and ends in terms of lines and columns)
and the input string itself -- stuff we don't care about.

So here's a perhaps more readable way to show what's going on...:

<font color="#990000">&gt;&gt;&gt; for x in tokenize.generate_tokens(cStringIO.StringIO(st).readline):</font>
...   print '%12s %r'%(tokenize.tok_name[x[0]], x[1])
...
        NAME 'FOO'
          OP '('
      NUMBER '1'
          OP ')'
        NAME 'BAR'
          OP '('
      STRING '&quot;2&quot;'
          OP ')'
   ENDMARKER ''
<font color="#990000">&gt;&gt;&gt;</font>

this still doesn't give you the dict you want, of course.
But then, we don't yet know what syntax your strings are in --
you haven't told us!  If the syntax is simple enough, and in
particular if you don't need to diagnose ERRORS in the input
strings, the task might perhaps be trivial...:

<font color="#990000">&gt;&gt;&gt; def makedict(st):</font>
...   thedict = {}
...   for x in tokenize.generate_tokens(cStringIO.StringIO(st).readline):
...     whattok = tokenize.tok_name[x[0]]
...     if whattok == 'NAME': name=x[1]
...     elif whattok in ('NUMBER','STRING'): thedict[name]=eval(x[1])
...   return thedict
...
<font color="#990000">&gt;&gt;&gt; makedict(st) {'FOO': 1, 'BAR': '2'}
&gt;&gt;&gt;</font>

here I'm ignoring punctuation, and just assuming that, apart from
punctuation and whitespace, the string is a sequence alternating
identifiers and values, where all values are numbers or strings.

Of course, it isn't very hard to perform more thorough checks, so
that you can identify mistakes in the input string -- or accept a
richer syntax for said input string -- but you'll really need to
tell us more about the latter's syntax before we can offer any
further help in these respects.


Alex</pre><p><font face=arial,sans-serif><i><a href="http://posting.google.com/post?cmd=post&enc=ISO-8859-1&msg=eOena.23056%24LB6.547891%40news1.tin.it&gs=/groups%3Fhl%3Den%26lr%3D%26ie%3DUTF-8%26selm%3DeOena.23056%2524LB6.547891%2540news1.tin.it%26rnum%3D2"(null)>Post a follow-up to this message</a></i></font></p><center><p><hr class=z><table width=100% cellpadding=2 cellspacing=0 border=0><tr><td class=t align=center><font size=-1><a href="http://www.google.com/">Google&nbsp;Home</a> - <a href="/ads/">Advertise&nbsp;with&nbsp;Us</a> - <a href="/services/">Business&nbsp;Solutions</a> - <a href="/options/">Services&nbsp;&amp;&nbsp;Tools</a> - <a href=/about.html>Jobs,&nbsp;Press,&nbsp;&amp;&nbsp;Help</a></font></table><br><font size=-1 class=p>&copy;2003 Google</font></center></body></html>
